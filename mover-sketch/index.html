<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Mover Animation</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
</head>
<body>
<script>
let sprite;
let movers = [];

function preload() {
  // load image (put sprite.png in same folder as index.html)
  sprite = loadImage("sprite.png");
}

function setup() {
  createCanvas(800, 600);
  for (let i = 0; i < 20; i++) {
    movers.push(new Mover(random(width), random(height)));
  }
}

function draw() {
  background(20, 30, 50);
  for (let m of movers) {
    m.update();
    m.checkEdges();
    m.display();
  }
}

// --- CLASS ---
class Mover {
  constructor(startX, startY) {
    this.x = startX;
    this.y = startY;
    this.xSpeed = random(-2, 2);
    this.ySpeed = random(-2, 2);
    this.noiseOffsetX = random(1000);
    this.noiseOffsetY = random(2000);
    this.c = color(random(255), random(255), random(255), 180);
  }
  
  update() {
    // Add some Perlin noise to make the path more organic
    this.x += map(noise(this.noiseOffsetX), 0, 1, -2, 2) + this.xSpeed;
    this.y += map(noise(this.noiseOffsetY), 0, 1, -2, 2) + this.ySpeed;

    this.noiseOffsetX += 0.01;
    this.noiseOffsetY += 0.01;
    
    // Change color depending on speed
    let speed = dist(0, 0, this.xSpeed, this.ySpeed);
    this.c = color(map(speed, 0, 4, 50, 255), random(150, 255), 200, 200);

    // Conditional rule: reverse if in central "zone"
    if (this.x > width/3 && this.x < 2*width/3 &&
        this.y > height/3 && this.y < 2*height/3) {
      this.xSpeed *= -1;
      this.ySpeed *= -1;
    }
  }
  
  checkEdges() {
    if (this.x < 0 || this.x > width) {
      this.xSpeed *= -1;
    }
    if (this.y < 0 || this.y > height) {
      this.ySpeed *= -1;
    }
  }
  
  display() {
    noStroke();
    fill(this.c);
    ellipse(this.x, this.y, 25, 25);
    
    imageMode(CENTER);
    tint(255, 180);
    image(sprite, this.x, this.y, 40, 40);
  }
}
</script>
</body>
</html>
